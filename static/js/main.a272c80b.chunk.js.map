{"version":3,"sources":["chat.js","trainer.js","start.js","index.js"],"names":["UserListBox","props","className","children","ChatBox","scrollWindow","bind","prevProps","this","maxScrollTop","chatWindow","scrollHeight","clientHeight","scrollTop","ref","div","Component","ChatContainer","state","input_text","chat_text","user_list","state_class","Msg","isChat","isDockPanel","target_user","alertMsg","videoMsg","closeMsg","serverUrl","webSocket","isAlive","isControlsDisabled","msg_connect","type","user_name","func","myUsername","countUpdate","typeChat","webcamStream","mediaConstraints","audio","video","aspectRatio","ideal","myPeerConnection","receiveVideo","localVideo","videoWidth","videoHeight","onChangeText","onClickSend","handlerKey","AnimationEnd","AnimationEndDock","chatClose","undockVideoPanel","dockVideoPanel","log","log_error","reportError","connect","ReconnectChat","onOpenConnection","onMessage","sendToServer","CheckConnection","CreateUserList","invite","createPeerConnection","handleGetUserMediaError","handleICECandidateEvent","handleICEConnectionStateChangeEvent","handleICEGatheringStateChangeEvent","handleSignalingStateChangeEvent","handleNegotiationNeededEvent","handleVideoOfferMsg","handleVideoAnswerMsg","handleTrackEvent","closeVideoCall","handleHangUpMsg","hangUpCall","videoCall","reInvite","closeVideoChat","onResize","applyAspectRatio","event","clientWidth","console","setState","render","isIE","isEdge","setTimeout","window","addEventListener","removeEventListener","close","clearInterval","checkAlive","target","value","msg","text","from_user","map","txt_block","d","Date","date","toLocaleDateString","toLocaleTimeString","length","push","keyCode","time","trace","errMessage","name","message","msgJSON","JSON","stringify","send","scheme","myHostname","ws_server","document","location","protocol","WebSocket","onopen","onmessage","setInterval","parse","data","list","receive_text","handleNewICECandidateMsg","items","user","index","key","str","i","charCodeAt","toString","getKey","a","navigator","mediaDevices","getUserMedia","srcObject","getTracks","forEach","track","addTransceiver","streams","err","RTCPeerConnection","iceServers","urls","credential","username","url","onicecandidate","oniceconnectionstatechange","onicegatheringstatechange","onsignalingstatechange","onnegotiationneeded","ontrack","e","candidate","createOffer","offer","signalingState","setLocalDescription","sdp","localDescription","iceConnectionState","iceGatheringState","toFixed","onnicecandidate","onnotificationneeded","getTransceivers","transceiver","stop","pause","desc","RTCSessionDescription","Promise","all","setRemoteDescription","createAnswer","catch","RTCIceCandidate","addIceCandidate","supports","getSupportedConstraints","getVideoTracks","applyConstraints","width","height","then","error","state_msg","state_msg2","chatbox","chat_class","onAnimationEnd","onClick","id","size","maxLength","onChange","placeholder","autoComplete","onKeyUp","disabled","dock_panel_class","dock_panel","src","autoPlay","msgBox","effect","effectOut","Passport","ClickPhoto","indexLevel","clientX","clientY","BlockExercise","Equipments","WrapColumn","MainExercise","level","ShowPhoto","complex_photos","complex_details","src_video","AddExercise","number","animation","last_element","last","DeleteMoreExercises","AlternativeExercises","exercises","exercise","splice","CreateTrainComponents","Exercises","rows","columns","complex","photos","details","buttonShow","moreExercises","photo","passport","rounds","reps","block","onButtonShowHadler","photo_equip","exercise_name","prev","count","column","ButtonShow","onChangeState","HeadBar","isMsg","isChatBox","onClickPlay","onChatBox","onVideoChatBox","onFullScreen","doc","docEl","documentElement","requestFullScreen","requestFullscreen","mozRequestFullScreen","webkitRequestFullScreen","msRequestFullscreen","cancelFullScreen","exitFullscreen","mozCancelFullScreen","webkitExitFullscreen","msExitFullscreen","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement","call","PlayVideo","player_class","controlScreen","player","isAndroid","isMobile","title","allow","allowFullScreen","ToolTip","toolTip","out","tool_class","clickHandler","style","left","posX","top","posY","TrainExercise","chat","headBarVisible","arrayVideo","onChatHandler","setVisibleHeadBar","visible","tooltip","detail","MessageBox","showBox","boxPos","class_box","isCloseState","isDownMouse","delta","ClickButton","handleMouseDown","handleMouseUp","handleMouseMove","textContent","rect","getBoundingClientRect","buttons","box","onMouseDown","onMouseMove","onMouseUp","ClipsAnimation","arrayClips","arrayImage","front_video","back_video","reverseIn","reverseOut","delayIn","delayOut","createClip","front_video_reverse","back_video_reverse","indexReverse","lastVideo","interval","shiftClips","createArrayClips","ReverseClip","PlayVideo_","reInitClips","shift","class_clip","classList","indexOf","remove","add","isDesktop","last_index","startsWith","play","myResolve","onanimationend","autoplay","loop","img","muted","delay","clearTimeout","Lenta","class_lenta","array_win","pos","AnimationText","class_name","text_id","AnimationHead","FormEntry","form_id","onLogon","onSaveData","isSaveData","InputsBlock","login","password","onChangeLogin","onChangePassword","onClickHandler","checked","Logon","class_logon","Start","showLogon","user_exist","users","agentInfo","onStateLogon","checkCookie","CheckUser","setCookie","getCookie","getConfig","account","fetch","result","json","usr_name","findIndex","usr_pass","conf_json","usr_conf","cookie","config","xhttp","XMLHttpRequest","onreadystatechange","readyState","status","responseText","ReactDOM","getElementById","open","cname","cvalue","exdays","setTime","getTime","expires","toGMTString","ca","decodeURIComponent","split","c","charAt","substring","prevState","display"],"mappings":"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","file":"static/js/main.a272c80b.chunk.js","sourcesContent":["import React, {Component} from 'react'\r\nimport {MessageBox} from './start'\r\nimport {\r\n  isIE,\r\n  isEdge\r\n} from \"react-device-detect\";\r\n/*import adapter from 'webrtc-adapter';*/\r\nimport './css/chat.css'\r\n\r\nfunction UserListBox(props) {\r\n\treturn <ul className=\"userslistbox\">{props.children}</ul>;\r\n}\r\n\r\nclass ChatBox extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.scrollWindow = this.scrollWindow.bind(this);\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps) {\r\n\t\tthis.scrollWindow();\r\n\t}\r\n\r\n\tscrollWindow() {\r\n\r\n\t\tconst scrollHeight = this.chatWindow.scrollHeight;\r\n\t\tconst height = this.chatWindow.clientHeight;\r\n\t\tconst maxScrollTop = scrollHeight - height;\r\n\t\tthis.chatWindow.scrollTop = maxScrollTop > 0 ? maxScrollTop : 0;\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn <div className=\"chat_window\" ref={(div) => {\r\n\t\t\tthis.chatWindow = div;\r\n\t\t}} >{this.props.children}</div>;\r\n\t}\r\n\t\r\n}\r\n\r\nclass ChatContainer extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {input_text:'',chat_text:[],user_list:null,state_class:'state_indicator_off',\r\n\t\t\t\t\t  Msg:null,isChat:null,isDockPanel:' ',target_user:null,alertMsg:null,\r\n\t\t\t\t\t  videoMsg:null,closeMsg:null\r\n\t\t\t\t\t };\r\n\t\t\r\n\t\tthis.serverUrl = '';\r\n\t\tthis.webSocket = null;\r\n\t\tthis.isAlive = false;\r\n\t\tthis.isControlsDisabled = true;\r\n\t\tthis.target_user = null;\r\n\t\tthis.msg_connect = {type:'connect_user',user_name:null,func:null};\r\n\t\tthis.myUsername = this.props.user_name;\r\n\t\tthis.countUpdate = 0;\r\n\t\tthis.typeChat = '';\r\n\r\n\t\tthis.webcamStream = null;\r\n\t\tthis.mediaConstraints = { audio: true,video: { aspectRatio: { ideal: 1.33 } }};\r\n\t\tthis.myPeerConnection = null;\r\n\t\tthis.receiveVideo = null;\r\n\t\tthis.localVideo = null;\r\n\t\tthis.videoWidth = 0;\r\n\t\tthis.videoHeight = 0;\r\n\t\r\n\t\tthis.onChangeText = this.onChangeText.bind(this);\r\n\t\tthis.onClickSend = this.onClickSend.bind(this);\r\n\t\tthis.handlerKey = this.handlerKey.bind(this);\r\n\t\r\n\t\tthis.AnimationEnd =  this.AnimationEnd.bind(this);\r\n\t\tthis.AnimationEndDock =  this.AnimationEndDock.bind(this);\r\n\t\tthis.chatClose =  this.chatClose.bind(this);\r\n\t\tthis.undockVideoPanel =  this.undockVideoPanel.bind(this);\r\n\t\tthis.dockVideoPanel =  this.dockVideoPanel.bind(this);\r\n\r\n\t\tthis.log = this.log.bind(this);\r\n\t\tthis.log_error = this.log_error.bind(this);\r\n\t\tthis.reportError = this.reportError.bind(this);\r\n\t\tthis.connect = this.connect.bind(this);\r\n\t\tthis.ReconnectChat = this.ReconnectChat.bind(this);\r\n\t\tthis.onOpenConnection = this.onOpenConnection.bind(this);\r\n\t\tthis.onMessage = this.onMessage.bind(this);\r\n\t\tthis.sendToServer = this.sendToServer.bind(this);\r\n\t\tthis.CheckConnection = this.CheckConnection.bind(this);\r\n\t\tthis.CreateUserList = this.CreateUserList.bind(this);\r\n\r\n\t\tthis.invite = this.invite.bind(this);\r\n\t\tthis.createPeerConnection = this.createPeerConnection.bind(this);\r\n\t\tthis.handleGetUserMediaError = this.handleGetUserMediaError.bind(this);\r\n\t\tthis.handleICECandidateEvent = this.handleICECandidateEvent.bind(this);\r\n\t\tthis.handleICEConnectionStateChangeEvent = this.handleICEConnectionStateChangeEvent.bind(this);\r\n\t\tthis.handleICEGatheringStateChangeEvent = this.handleICEGatheringStateChangeEvent.bind(this);\r\n\t\tthis.handleSignalingStateChangeEvent = this.handleSignalingStateChangeEvent.bind(this);\r\n\t\tthis.handleNegotiationNeededEvent = this.handleNegotiationNeededEvent.bind(this);\r\n\t\tthis.handleVideoOfferMsg = this.handleVideoOfferMsg.bind(this);\r\n\t\tthis.handleVideoAnswerMsg = this.handleVideoAnswerMsg.bind(this);\r\n\t\tthis.handleTrackEvent = this.handleTrackEvent.bind(this);\r\n\t\tthis.closeVideoCall = this.closeVideoCall.bind(this);\r\n\t\tthis.handleHangUpMsg = this.handleHangUpMsg.bind(this);\r\n\t\tthis.hangUpCall = this.hangUpCall.bind(this);\r\n\t\tthis.videoCall = this.videoCall.bind(this);\r\n\t\tthis.reInvite = this.reInvite.bind(this);\r\n\t\tthis.closeVideoChat = this.closeVideoChat.bind(this);\r\n\t\tthis.onResize = this.onResize.bind(this);\r\n\t\tthis.applyAspectRatio = this.applyAspectRatio.bind(this);\r\n\t}\r\n\r\n\tonResize(event) {\r\n\t\t\r\n\t\tthis.videoHeight = this.receiveVideo.clientHeight;\r\n\t\tthis.videoWidth = this.receiveVideo.clientWidth;\t\r\n\t\tconsole.log('new width=',this.videoWidth,'new height=',this.videoHeight);\r\n\t\tthis.applyAspectRatio();\r\n\t}\r\n\r\n\tAnimationEnd() {\r\n\t\tif (!this.msg_connect.user_name && this.state.isChat=='show' && this.state.isDockPanel==' ') {\r\n\r\n\t\t\tthis.setState ({Msg:'Нет связи с WebSocket сервером сигнализации или он выключен. Повторить попытку?'});\r\n\t\t\t\r\n\t\t}\r\n\t\tif (this.state.isChat=='close') {\r\n\r\n\t\t\tthis.props.render();\r\n\t\t}\r\n\t}\r\n\r\n\tAnimationEndDock() {\r\n\t\tif (this.state.isDockPanel=='undock')\r\n\t\t\tthis.setState({isDockPanel:null});\r\n\t\tif (this.state.isDockPanel=='dock')\r\n\t\t\tthis.setState({isDockPanel:' '});\r\n\t\tif (this.state.isChat=='close') {\r\n\r\n\t\t\tthis.props.render();\r\n\t\t}\r\n\t}\r\n\r\n\tdockVideoPanel() {\r\n\t\tif (this.state.isDockPanel != ' ')\r\n\t\t\tthis.setState({isDockPanel:'dock'});\r\n\t}\r\n\r\n\tundockVideoPanel() {\r\n\t\tthis.setState({isDockPanel:'undock'});\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps) {\r\n\t\r\n\t\tif (this.state.isChat=='show' && (isIE || isEdge) && !this.msg_connect.user_name && this.countUpdate<2) {\r\n\t\t\tif (++this.countUpdate==2) {\t\r\n\r\n\t\t\t\tthis.setState ({Msg:'Нет связи с WebSocket сервером сигнализации или он выключен. Повторить попытку?'});\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\t\tif (this.state.isChat=='close' && (isIE || isEdge)) {\r\n\t\t\tsetTimeout (()=>{this.props.render();},1500);\r\n\t\t}\r\n\t\tif (this.typeChat == 'videoChat' && !this.videoHeight && !this.videoWidth) {\r\n\t\t\tthis.videoHeight = this.receiveVideo.clientHeight;\r\n\t\t\tthis.videoWidth = this.receiveVideo.clientWidth;\t\r\n\t\t\tconsole.log('start width=',this.videoWidth,'start height=',this.videoHeight);\t\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\t \r\n\t\tthis.typeChat = this.props.typeChat;\t\r\n\t\tif (this.typeChat == 'videoChat') {\r\n\t\t\twindow.addEventListener(\"resize\", this.onResize);\r\n\t\t}\r\n\t\tthis.setState ({isChat:'show'});\r\n\t\tif (!this.webSocket)\r\n\t\t{\r\n\t\t\tthis.connect ();\r\n\t\t}\t\t\t\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tif (this.typeChat=='videoChat') {\r\n\t\t\twindow.removeEventListener(\"resize\", this.onResize);\r\n\t\t}   \r\n\t}\r\n\r\n\tchatClose() {\r\n\t\tif (this.typeChat=='videoChat' && this.myPeerConnection) {\r\n\t\t\tthis.setState ({closeMsg:'Закрыть видеочат и завершить видеосвязь?'});\r\n\t\t} else {\r\n\r\n\t\t\tif (this.webSocket !=null)\r\n\t\t    \tthis.webSocket.close ();\t\r\n\t\t    clearInterval(this.checkAlive);\r\n\t\t\tthis.setState ({isChat:'close'});\t\t\t\r\n\t\t}\t\t\r\n\t}\r\n\r\n\tonChangeText(event) {\r\n\t\t this.setState({input_text: event.target.value});\r\n\t}\r\n\r\n\tonClickSend(event) {\r\n\t\t var input_text = this.state.input_text;\r\n\t\t var msg = {\r\n\t\t \ttype: \"message_touser\",\r\n\t\t    text: input_text,\r\n\t\t    target:this.target_user,\r\n\t\t    from_user:this.props.user_name\r\n\t\t };\r\n\r\n\t\t if (input_text=='')\r\n\t\t \treturn;\r\n\r\n\t\t this.sendToServer(msg);\r\n\t\t var chat_text = this.state.chat_text.map(txt_block=> {\r\n\t\t \treturn txt_block;\r\n\t\t });\r\n\r\n\t\t var d = new Date();\r\n\t\t var date = d.toLocaleDateString()+' '+d.toLocaleTimeString();\r\n\r\n\t\t var txt_block = <span key={chat_text.length}><span className='chat_date'>{date}</span>\r\n\t\t \t\t\t\t\t  <span className='chat_send_txt'>{input_text}<br/></span>\r\n\t\t \t\t\t\t </span>;\r\n\t\t chat_text.push (txt_block);\r\n         this.setState({chat_text: chat_text});\r\n\t\t this.setState({input_text: ''});\r\n\t}\r\n\r\n\thandlerKey(event) {\r\n\t\tif (event.keyCode === 13 || event.keyCode === 14) {\r\n\t\t  this.onClickSend();\r\n\t\t}\r\n\t}\r\n\r\n\tlog(text) {\r\n\t\tvar time = new Date();\r\n\r\n\t\tconsole.log(\"[\" + time.toLocaleTimeString() + \"] \" + text);\r\n\t}\r\n\r\n\tlog_error(text) {\r\n\t\tvar time = new Date();\r\n\r\n\t\tconsole.trace(\"[\" + time.toLocaleTimeString() + \"] \" + text);\r\n\t}\r\n\r\n\treportError(errMessage) {\r\n\t\tthis.log_error(`Error ${errMessage.name}: ${errMessage.message}`);\r\n\t}\r\n\r\n\tsendToServer(msg) {\r\n\t\tvar msgJSON = JSON.stringify(msg);\r\n\r\n\t\tthis.log(\"Sending '\" + msg.type + \"' message: \" + msgJSON);\r\n\t\tthis.webSocket.send(msgJSON);\r\n\t}\r\n\r\n\tReconnectChat(state) {\r\n\t\tif (state=='Да')\r\n\t    {\r\n\t    \tthis.log (\"Переустановка websocket соединения  ..\");\r\n\t    \tif (this.webSocket !=null)\r\n\t    \t\tthis.webSocket.close ();\r\n\t\t\tthis.connect ();\r\n\t    }\t    \r\n\t}\r\n\r\n\tconnect() {\r\n\r\n\t\tvar scheme = \"ws\";\r\n\t\tvar myHostname = this.props.ws_server;\r\n//\t\tvar myHostname = window.location.hostname;\r\n/*\t\tif (!myHostname) {\r\n\t  \t\tmyHostname = \"localhost\";\r\n\t\t}*/\r\n\t\tconsole.log(\"Hostname: \", myHostname);\r\n\r\n\t\tif (document.location.protocol === \"https:\") {\r\n\t\t  \tscheme += \"s\";\r\n\t\t}\r\n\t//\tthis.serverUrl = scheme + \"://\" + myHostname + \":8080\";\r\n\t\tthis.serverUrl = scheme + myHostname;\r\n\t\tconsole.log('Connecting to server: ',this.serverUrl);\r\n\t\tthis.webSocket = new WebSocket(this.serverUrl);\r\n\r\n\t\tthis.webSocket.onopen = this.onOpenConnection;\r\n\t\tthis.webSocket.onmessage = this.onMessage;\r\n\r\n\t}\r\n\r\n\tonOpenConnection() {\r\n\t\tconsole.log ('connection_open ..');\r\n\t\tthis.msg_connect.user_name = this.myUsername;\r\n\t\tif (this.msg_connect.user_name=='yarikfanat')\r\n\t\t\tthis.msg_connect.func = 'trainer';\r\n\t\telse\r\n\t\t\tthis.msg_connect.func = 'client';\r\n\t\tthis.isAlive = true;\r\n\r\n\t\tthis.webSocket.send(JSON.stringify(this.msg_connect));\t\r\n\t\tthis.checkAlive = setInterval (this.CheckConnection,15000);\r\n\t\tthis.setState({state_class: 'state_indicator_on'});\r\n\t}\r\n\r\n\tonMessage(event) {\r\n\t\tvar msg = JSON.parse(event.data);\t\t\t\r\n\r\n\t\tswitch(msg.type) {\r\n\t\t\tcase \"user_list\":\r\n\t\t\t\tconsole.log ('получено сообщение ',msg.list);\r\n\t\t      \tthis.CreateUserList (msg.list);\r\n\t\t      \tbreak;\r\n\t\t\t   \r\n\t\t    case \"message\":\r\n\t\t    \tconsole.log ('получено сообщение от ',msg.from_user,'=>',msg.text);\r\n\r\n\t\t    \tvar space = ' ';\r\n\t\t    \tvar chat_text = this.state.chat_text.map(txt_block=> {\r\n\t\t    \t\treturn txt_block;\r\n\t\t    \t});\r\n\r\n\t\t\t\tvar receive_text = <span key={chat_text.length}><span className='chat_date'>{msg.date}</span><span className='chat_from_user'>{space}{msg.from_user}{'=> '}</span>\r\n\t\t\t\t\t\t\t\t   <span className='chat_receive_txt'>{msg.text}<br/></span></span>;\r\n\t\t\t\tchat_text.push (receive_text);\r\n\t\t\t\tthis.setState({chat_text: chat_text});\r\n\t\t\t    break;\r\n\r\n\t\t    case \"video-offer\":  \r\n\t\t    \tthis.handleVideoOfferMsg(msg);\r\n\t\t    \tbreak;\r\n\r\n\t\t    case \"video-answer\":  \r\n\t\t    \tthis.handleVideoAnswerMsg(msg);\r\n\t          \tbreak;\r\n\t\t    case \"new-ice-candidate\": \r\n\t\t    \tthis.handleNewICECandidateMsg(msg);\r\n\t\t      \tbreak;\r\n\r\n\t\t    case \"hang-up\": \r\n\t\t    \tthis.handleHangUpMsg(msg);\r\n\t\t      \tbreak;\r\n\t\t     \r\n\t\t    case \"ping_\":\r\n\t\t    \tthis.sendToServer ({type:'pong_'});  \t         \r\n\t\t      \tbreak;\r\n\t\t\tcase \"ping\":\r\n\t\t\t  \tvar d = new Date();\r\n\t          \tvar date = d.toLocaleDateString()+' '+d.toLocaleTimeString();\r\n\t\t\t  \tthis.isAlive=true;\r\n\t\t\t  \tconsole.log (date,' получен ping от сервера <я жив>');\r\n\t\t\t  \tbreak;\t\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tCreateUserList(user_list) {\r\n\t\tfunction getKey(str){\r\n\t      let key = 0;\r\n\t      for (let i = 0; i < str.length; i++) {\r\n\t        key += str.charCodeAt(i);\r\n\t      }\r\n\t      return key.toString();\r\n\t    }\r\n\t    this.target_user = null;\r\n\t\tconst items = user_list.map((user,index) => {\r\n      \t\tconst key = getKey(user);\r\n      \t\tif (!index)\r\n      \t\t\tthis.target_user = user;\r\n      \t\treturn <li key={key}>{user}</li>;\r\n    \t});\r\n    \tuser_list.length>0? this.isControlsDisabled = false:this.isControlsDisabled = true;\r\n    \tif (this.typeChat=='videoChat')\r\n    \t\tthis.setState ({target_user:this.target_user});\r\n    \telse\r\n    \t\tthis.setState ({user_list:items});\r\n\r\n\t}\r\n\r\n\tCheckConnection() {\r\n\t\tvar d = new Date();\r\n\t\tvar date = d.toLocaleDateString()+' '+d.toLocaleTimeString();\r\n\t\t\t\r\n\t\tif (this.isAlive==true)\r\n\t\t{\r\n\t\t\tconsole.log (date,' checkAlive()=> соединение живое ');\r\n\t\t\tthis.isAlive=false;\r\n\r\n\t\t\tconsole.log ('Отправляю pong серверу');\r\n\t\t    this.sendToServer ({type:'pong'});\r\n\t\t}else\r\n\t\t{\r\n\t\t\tconsole.log (date,' checkAlive()=> соединение умерло . Нужен reconnect');\t\r\n\t\t\tthis.msg_connect.user_name = null;\t\r\n\t\t\tthis.setState({state_class: 'state_indicator_off'})\t\t\t\r\n\t\t\tclearInterval(this.checkAlive);\r\n\t\t\tthis.log(`ReConnecting to server: ${this.serverUrl}`);\r\n\t\t\tif (this.webSocket !=null)\r\n\t\t\t\tthis.webSocket.close ();\r\n\t\t\tthis.connect ();\r\n\t\t}\r\n\t}\r\n\r\n\tvideoCall() {\r\n\t\tif (this.myPeerConnection) {\r\n\t\t\tthis.setState ({videoMsg:'Завершить текущий видеозвонок и перезапустить заново?'});\r\n\t\t} else\r\n\t\t\tthis.invite();\r\n\t}\r\n\r\n\treInvite(state) {\r\n\t\tif (state=='Да') {\r\n\r\n\t\t\tthis.hangUpCall();\r\n\t\t\tthis.invite();\r\n\t\t}\r\n\t}\r\n\r\n\tcloseVideoChat(state) {\r\n\t\tif (state=='Да') {\r\n\r\n\t\t\tthis.hangUpCall();\r\n\t\t\tthis.chatClose();\r\n\t\t}\r\n\t}\r\n\r\n\tasync invite() {\r\n\t\tif (this.msg_connect.user_name == null) {\r\n\t\t\tthis.setState ({alertMsg:'Видеозвонок не возможен. Вы не подключены к серверу сигнализации'});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.target_user == null) {\r\n\t\t\tthis.setState ({alertMsg:'Видеозвонок не возможен. Нет подключенного собеседника'});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.log(\"Стартую видеозвонок\");\r\n\t\t \r\n\t\tthis.log(\"Inviting user \" + this.target_user);\r\n\t\tthis.log(\"Установка соединения с: \" + this.target_user);\r\n\t\tthis.createPeerConnection();\r\n\r\n\t\ttry {\r\n\t\t    \r\n\t\t    this.webcamStream = await navigator.mediaDevices.getUserMedia(this.mediaConstraints);\r\n\t\t    this.localVideo.srcObject = this.webcamStream;\r\n\t\t} catch(err) {\r\n\r\n\t\t  this.handleGetUserMediaError(err);\r\n\t\t  return;\r\n\t\t}\r\n\t\t\r\n\t\ttry {\r\n\t\t\tthis.webcamStream.getTracks().forEach(\r\n\t\t\t\ttrack => this.myPeerConnection.addTransceiver(track, {streams: [this.webcamStream]})\r\n\t\t    );\r\n\t\t} catch(err) {\r\n\r\n\t\t  this.handleGetUserMediaError(err);\r\n\t\t}\r\n\t}\r\n\r\n\tasync createPeerConnection() {\r\n\t\tthis.log(\"Настройка соединения...\");\r\n\r\n\t\tthis.myPeerConnection = new RTCPeerConnection({\r\n\t\t\ticeServers: [     \r\n\t\t\t\t\t      \t{ \turls: [\"stun:stun.stunprotocol.org\",\"stun:stun1.l.google.com:19302\",\"stun:stun2.l.google.com:19302\",\r\n\t\t\t\t\t\t\t\t\t   \"stun:stun4.l.google.com:19302\",\"stun:stun.ekiga.net\",\"stun:stun.ideasip.com\",\"stun:stun.rixtelecom.se\",\r\n\t\t\t\t\t\t\t\t\t   \"stun:stun.schlund.de\"] \r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t    {\r\n\t\t\t\t\t\t      \turls: \"turn:192.158.29.39:3478?transport=udp\", \r\n\t\t\t\t\t\t      \tcredential: 'JZEOEt2V3Qb0y27GRntt2u2PAYA=', \r\n\t\t\t\t\t     \t\tusername: '28224511:1379330808' \r\n\t\t\t\t\t\t    },\r\n\t\t\t\t\t\t    {\r\n\t\t\t\t\t\t    \turls: 'turn:numb.viagenie.ca',\r\n\t\t    \t\t\t\t\tcredential: 'muazkh',\r\n\t\t    \t\t\t\t\tusername: 'webrtc@live.com'\r\n\t\t\t\t\t\t    },\r\n\t\t\t\t\t\t    {\r\n\t\t\t\t\t\t\t    url: 'turn:turn.bistri.com:80',\r\n\t\t\t\t\t\t\t    credential: 'homeo',\r\n\t\t\t\t\t\t\t    username: 'homeo'\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t    url: 'turn:turn.anyfirewall.com:443?transport=tcp',\r\n\t\t\t\t\t\t\t    credential: 'webrtc',\r\n\t\t\t\t\t\t\t    username: 'webrtc'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t});\r\n\t\tthis.myPeerConnection.onicecandidate = this.handleICECandidateEvent;\r\n\t\tthis.myPeerConnection.oniceconnectionstatechange = this.handleICEConnectionStateChangeEvent;\r\n\t\tthis.myPeerConnection.onicegatheringstatechange = this.handleICEGatheringStateChangeEvent;\r\n\t\tthis.myPeerConnection.onsignalingstatechange = this.handleSignalingStateChangeEvent;\r\n\t\tthis.myPeerConnection.onnegotiationneeded = this.handleNegotiationNeededEvent;\r\n\t\tthis.myPeerConnection.ontrack = this.handleTrackEvent;\r\n\t}\r\n\r\n\r\n\thandleGetUserMediaError(e) {\r\n\t\tthis.log_error(e);\r\n\r\n\t\tswitch(e.name) {\r\n\t\t    case \"NotFoundError\":\r\n\r\n\t\t    \tthis.setState ({alertMsg:'Не могу начать видеозвонок, так как не обнаружены камера/микрофон'});\r\n\t\t      \tbreak;\r\n\t\t    case \"SecurityError\":\r\n\t\t    case \"PermissionDeniedError\":\r\n\r\n\t\t      \tbreak;\r\n\t\t    default:\r\n\r\n\t\t    \tvar msg = \"Ошибка открытия вашей камеры/микрофона: \" + e.message;\r\n\t\t    \tthis.setState ({alertMsg:msg});\r\n\t\t      \tbreak;\r\n\t\t}\r\n\r\n\t  \tthis.closeVideoCall();\r\n\t}\r\n\r\n\thandleICECandidateEvent(event) {\r\n\r\n\t\tif (event.candidate) {\r\n\t\t\tthis.log(\"*** Отправка ICE кандидатов: \" + event.candidate.candidate);\r\n\r\n\t\t\tthis.sendToServer({\r\n\t\t\t\ttype: \"new-ice-candidate\",\r\n\t\t\t\ttarget: this.target_user,\r\n\t\t\t\tcandidate: event.candidate,\r\n\t\t\t\tfrom_user: this.myUsername\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\thandleTrackEvent(event) {\r\n\r\n\t\tthis.log(\"*** Track event\");\r\n\t\tthis.receiveVideo.srcObject = event.streams[0];\r\n\t}\r\n\r\n\tasync handleNegotiationNeededEvent() {\r\n\r\n\t\tthis.log(\"*** Negotiation needed\");\r\n\r\n\t\ttry {\r\n\r\n\t\t\tthis.log(\"---> Creating offer\");\r\n\t\t\tconst offer = await this.myPeerConnection.createOffer();\r\n\r\n\t\t\tif (this.myPeerConnection.signalingState != \"stable\") {\r\n\r\n\t\t\t\tthis.log(\"-- The connection isn't stable yet; postponing...\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.log(\"---> Setting local description to the offer\");\r\n\t\t\tawait this.myPeerConnection.setLocalDescription(offer);\r\n\r\n\t\t\tthis.log(\"---> Отсылаю видео-предложение на удаленный узел\");\r\n\r\n\t\t\tthis.sendToServer({\r\n\t\t\t\tfrom_user: this.myUsername,\r\n\t\t\t\ttarget: this.target_user,\r\n\t\t\t\ttype: \"video-offer\",\r\n\t\t\t\tsdp: this.myPeerConnection.localDescription\r\n\t\t\t});\r\n\t\t} catch(err) {\r\n\r\n\t\t\tthis.log(\"*** The following error occurred while handling the negotiationneeded event:\");\r\n\t\t\tthis.reportError(err);\r\n\t\t}\r\n\t}\r\n\r\n\thandleICEConnectionStateChangeEvent(event) {\r\n\r\n\t\tthis.log(\"*** ICE connection state changed to \" + this.myPeerConnection.iceConnectionState);\r\n\r\n\t\tswitch(this.myPeerConnection.iceConnectionState) {\r\n\t\t\tcase \"closed\":\r\n\t\t\tcase \"failed\":\r\n\t\t\tcase \"disconnected\":\r\n\r\n\t\t\t\tthis.closeVideoCall();\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\thandleSignalingStateChangeEvent(event) {\r\n\r\n\t\tthis.log(\"*** WebRTC signaling state changed to: \" + this.myPeerConnection.signalingState);\r\n\r\n\t\tswitch(this.myPeerConnection.signalingState) {\r\n\r\n\t\t\tcase \"closed\":\r\n\r\n\t\t\t\tthis.closeVideoCall();\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\thandleICEGatheringStateChangeEvent(event) {\r\n\r\n\t\tthis.log(\"*** ICE gathering state changed to: \" + this.myPeerConnection.iceGatheringState);\r\n\r\n\t\tif (this.myPeerConnection.iceGatheringState=='complete') {\r\n\t\t\tvar aspectRatio = this.videoWidth/this.videoHeight;\r\n\t\t\tif (aspectRatio.toFixed(1)!=1.3)\r\n\t\t\t\tthis.applyAspectRatio ();\r\n\t\t}\r\n\t}\r\n\r\n\tcloseVideoCall() {\r\n\r\n\t\tthis.log(\"Closing the call\");\r\n\r\n\t\tif (this.myPeerConnection) {\r\n\r\n\t\t\tthis.log(\"--> Closing the peer connection\");\r\n\t\t\tthis.myPeerConnection.ontrack = null;\r\n\t\t\tthis.myPeerConnection.onnicecandidate = null;\r\n\t\t\tthis.myPeerConnection.oniceconnectionstatechange = null;\r\n\t\t\tthis.myPeerConnection.onsignalingstatechange = null;\r\n\t\t\tthis.myPeerConnection.onicegatheringstatechange = null;\r\n\t\t\tthis.myPeerConnection.onnotificationneeded = null;\r\n\r\n\t\t\tthis.myPeerConnection.getTransceivers().forEach(transceiver => {\r\n\t\t\t\ttransceiver.stop();\r\n\t\t\t});\r\n\r\n\t\t\tif (this.localVideo.srcObject) {\r\n\r\n\t\t\t\tthis.localVideo.pause();\r\n\t\t\t\tthis.localVideo.srcObject.getTracks().forEach(track => {\r\n\t\t\t\t\ttrack.stop();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tthis.myPeerConnection.close();\r\n\t\t\tthis.myPeerConnection = null;\r\n\t\t\tthis.webcamStream = null;\r\n\t\t}\r\n\t}\r\n\r\n\tasync handleVideoOfferMsg(msg) {\r\n\r\n\t\tthis.log(\"Received video chat offer from \" + msg.from_user);\r\n\t\tif (!this.myPeerConnection) {\r\n\r\n\t\t\tthis.createPeerConnection();\r\n\t\t}\r\n\r\n\t\tvar desc = new RTCSessionDescription(msg.sdp);\r\n\r\n\t\tif (this.myPeerConnection.signalingState != \"stable\") {\r\n\r\n\t\t\tthis.log(\"  - But the signaling state isn't stable, so triggering rollback\");\r\n\t\t\tawait Promise.all([\r\n\r\n\t\t\t\tthis.myPeerConnection.setLocalDescription({type: \"rollback\"}),\r\n\t\t\t\tthis.myPeerConnection.setRemoteDescription(desc)\r\n\t\t\t\t]);\r\n\r\n\t\t\treturn;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.log (\"  - Setting remote description\");\r\n\t\t\tawait this.myPeerConnection.setRemoteDescription(desc);\r\n\t\t}\r\n\r\n\t\tif (!this.webcamStream) {\r\n\r\n\t\t\ttry {\r\n\r\n\t\t\t\tthis.webcamStream = await navigator.mediaDevices.getUserMedia(this.mediaConstraints);\r\n\t\t\t} catch(err) {\r\n\r\n\t\t\t\tthis.handleGetUserMediaError(err);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.localVideo.srcObject = this.webcamStream;\r\n\t\t\ttry {\r\n\r\n\t\t\t\tthis.webcamStream.getTracks().forEach(\r\n\t\t\t\t\ttrack => this.myPeerConnection.addTransceiver(track, {streams: [this.webcamStream]})\r\n\t\t\t\t\t);\r\n\r\n\t\t\t} catch(err) {\r\n\r\n\t\t\t\tthis.handleGetUserMediaError(err);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.log(\"---> Отправка видео-ответа вызывающему\");\r\n\t\tawait this.myPeerConnection.setLocalDescription(await this.myPeerConnection.createAnswer());\r\n\r\n\t\tthis.sendToServer({\r\n\t\t\tfrom_user: this.myUsername,\r\n\t\t\ttarget: this.target_user,\r\n\t\t\ttype: \"video-answer\",\r\n\t\t\tsdp: this.myPeerConnection.localDescription\r\n\t\t});\r\n\t}\r\n\r\n\tasync handleVideoAnswerMsg(msg) {\r\n\r\n\t\tthis.log(\"*** Call recipient has accepted our call\");\r\n\r\n\t\tvar desc = new RTCSessionDescription(msg.sdp);\r\n\t\tawait this.myPeerConnection.setRemoteDescription(desc).catch(this.reportError);\r\n\t}\r\n\r\n\tasync handleNewICECandidateMsg(msg) {\r\n\t\tvar candidate = new RTCIceCandidate(msg.candidate);\r\n\r\n\t\tthis.log(\"*** Добавляю принятых ICE кандидатов: \" + JSON.stringify(candidate));\r\n\t\ttry {\r\n\r\n\t\t\tawait this.myPeerConnection.addIceCandidate(candidate)\r\n\t\t} catch(err) {\r\n\t\t\tthis.reportError(err);\r\n\t\t}\r\n\t} \r\n\r\n\thandleHangUpMsg(msg) {\r\n\t\tvar closeMsg = this.target_user+' завершил видеосвязь. Закрыть видеочат?';\r\n\r\n\t\tthis.log(\"*** Принято hang up сообщение от удаленного узла\");\r\n\t\tthis.closeVideoCall();\r\n\t\tthis.setState ({closeMsg:closeMsg});\r\n\t}\r\n\r\n\thangUpCall() {\r\n\t\tvar msg={\r\n\t\t\tfrom_user: this.myUsername,\r\n\t\t\ttarget: this.target_user,\r\n\t\t\ttype: \"hang-up\"\r\n\t\t};\r\n\r\n\t\tthis.closeVideoCall();\r\n\t\tthis.sendToServer(msg);\r\n\t}\r\n\r\n\tapplyAspectRatio () {\r\n\t\tvar supports = navigator.mediaDevices.getSupportedConstraints();\r\n\t\t\r\n\t\tconsole.log ('supports contraints->',supports);\r\n\t\tif (!supports[\"width\"]) {\r\n\r\n\t\t\tconsole.log ('getSupportedConstraints() :ограничение [\"width\"] не поддерживается ');\r\n\t\t\treturn ;\r\n\t\t}\r\n\t\t\r\n\t\tconsole.log ('Установка  параметров <Receive видео> :width=',this.videoWidth,' height=',this.videoHeight);\r\n\t\ttry {\r\n\t\t\t\tthis.receiveVideo.srcObject.getVideoTracks().forEach((track)=> {\r\n\t\t\t\t\ttrack.applyConstraints({\r\n\t\t\t\t\t\twidth: {ideal:this.videoWidth},\r\n\t\t\t\t\t\theight: {ideal:this.videoHeight},\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then (()=> {\r\n\t\t\t\t\t\tconsole.log ('Sucessfull applyConstraints width=',this.videoWidth,'Height=',this.videoHeight);\r\n\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch (e => {\r\n\t\t\t\t\t\tconsole.log ('The constraints could not be satisfied by the available devices');\r\n\t    \t\t\t\t\t// The constraints could not be satisfied by the available devices.\r\n\t  \t\t\t\t});\r\n\r\n\t\t\t\t});\r\n\t\t} catch (err) {\r\n\r\n\t\t\tconsole.error('Ошибка при установке новых настроек экрана Receive видео->', err.message);\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tvar state_msg,state_msg2;\r\n\t\tvar chatbox;\r\n\t\tvar user_list = this.state.user_list;\r\n\t\tvar chat_text = this.state.chat_text;\r\n\t\tvar chat_class;\r\n\r\n\t\tif (this.typeChat=='textChat') \r\n\t\t\tchat_class='chat_container';\r\n\t\telse\r\n\t\t\tchat_class='video_chat_container';\r\n\r\n\t\tif (this.state.isChat=='show') {\r\n\t\t\tchat_class += ' animate__animated animate__bounceInLeft';\r\n\t\t} \r\n\t\tif (this.state.isChat=='close') {\r\n\t\t\tchat_class += ' animate__animated animate__rotateOut';\r\n\t\t}\r\n\t\t(this.state.state_class=='state_indicator_on')?state_msg = 'Соединение активно':state_msg = 'Соединение не активно';\r\n\t\t(this.state.state_class=='state_indicator_on')?state_msg2 = 'Активно':state_msg2 = 'Не активно';\r\n\r\n\t\tif (this.typeChat=='textChat') {\r\n\t\t\t\r\n\t\t\tchatbox = <div className='modal_chat'>\r\n\t\t\t\t\t\t<div className={chat_class} onAnimationEnd={this.AnimationEnd}>\r\n\t\t\t\t\t\t\t<div className='chat_upper_panel'>\r\n\t\t\t\t\t\t\t\t<div className='upper_panel_name'>Текстовый чат</div>\r\n\t\t\t\t\t\t\t\t<div className='upper_panel_close' onClick={this.chatClose}>\r\n\t\t\t\t\t\t\t\t\t<div className='button_close'>X</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t        \t\t<div className='chat_header_container'>\r\n\t\t\t        \t\t\t<div className='chat_head'>Чат</div>\r\n\t\t\t        \t\t\t<div className='users_head'>Пользователи</div>\r\n\t\t\t        \t\t</div>\r\n\t\t\t        \t\t<div className='chat_box_container'>\r\n\t\t\t        \t\t\t<div className='chat_head_'>Чат</div>\r\n\t\t\t        \t\t\t<ChatBox>{chat_text}</ChatBox>\r\n\t\t\t        \t\t\t<div className='users_head_'>Пользователи</div>\r\n\t\t\t        \t\t\t<UserListBox>{user_list}</UserListBox>\r\n\t\t\t        \t\t</div>\r\n\t\t\t        \t\t<div className='chat_controls_container'>\t\t\t        \t\t\t\r\n\t\t\t        \t\t\t<fieldset className='state_network'>\r\n   \t\t\t\t\t\t\t\t\t<legend>Состояние сети</legend>\r\n   \t\t\t\t\t\t\t\t\t<div className='state_block'>\r\n   \t\t\t\t\t\t\t\t\t\t<div id='st1'>Чат:</div><div className={this.state.state_class}></div><div>{state_msg}</div>\r\n   \t\t\t\t\t\t\t\t\t</div>\r\n   \t\t\t\t\t\t\t\t\t<div className='state_control'>\r\n   \t\t\t\t\t\t\t\t\t\t<input type=\"button\" name=\"socketReconnect\" value=\"Reconnect chat\" id='reconnect' \r\n\t\t\t\t\t\t\t\t\t   \t\tonClick={()=>{this.setState({Msg:'Сбросить текущее websocket соединение и установить заново?'});}} />\r\n   \t\t\t\t\t\t\t\t\t</div>\r\n   \t\t\t\t\t\t\t\t</fieldset>\r\n\t\t\t        \t\t\t<div className='send_controls'>\r\n\t\t\t        \t\t\t\t<input type=\"text\" name=\"text\" size=\"100\" maxLength=\"256\" value={this.state.input_text} onChange={this.onChangeText} placeholder=\"Здесь набирается текст ...\" \r\n\t\t\t\t\t\t\t\t\t  \tid=\"text_chat\" autoComplete=\"off\" onKeyUp={this.handlerKey} disabled={this.isControlsDisabled} />\r\n\t\t\t\t\t\t\t\t\t<input type=\"button\" name=\"send\" value=\"Send\" id=\"send\" onClick={this.onClickSend} disabled={this.isControlsDisabled} />\r\n\t\t\t        \t\t\t</div>\r\n\t\t\t        \t\t</div>\r\n\t\t\t        \t</div>\r\n\t\t\t\t\t  </div>;\r\n\r\n\t\t}\t \r\n\t\tif (this.typeChat=='videoChat') {\r\n\t\t\t\r\n\t\t\tvar dock_panel_class = 'video_dock_panel';\r\n\r\n\t\t\tif (this.state.isDockPanel && this.state.isDockPanel!=' ') {\r\n\t\t\t\t(this.state.isDockPanel=='undock')?dock_panel_class+=' animate__animated animate__backOutUp':dock_panel_class+=' animate__animated animate__bounceInDown';\r\n\t\t\t}\r\n\r\n\t\t\tvar dock_panel = <div className={dock_panel_class} onAnimationEnd={this.AnimationEndDock}>\r\n\t\t\t\t\t\t\t\t<fieldset className='video_control_block'>\r\n\t\t\t\t\t\t\t\t\t<legend>Состояние сети</legend>\r\n\t\t\t\t\t\t\t\t\t<div className='button_network' onClick={()=>{this.setState({Msg:'Сбросить текущее websocket соединение и установить заново?'});}}>\r\n\t\t\t\t\t\t\t\t\t\t<div className={this.state.state_class}></div><div id='st3'>{state_msg}</div><div id='st2'>{state_msg2}</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className='button_video_call' onClick={this.videoCall}>\r\n\t\t\t\t\t\t\t\t\t\t<img src='img/video_call.png' className='video_call'/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className='button_hide_panel' onClick={this.undockVideoPanel}>\r\n\t\t\t\t\t\t\t\t\t\t<img src='img/undock_panel.png' className='video_undock_panel'/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className='user_name_container'>\r\n\t\t\t\t\t\t\t\t\t\t<img src='img/abonent-26.png' />\r\n\t\t\t\t\t\t\t\t\t\t<span>{this.state.target_user}</span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</fieldset>\r\n\t\t\t\t\t\t\t</div>;\r\n\r\n\t\t\tchatbox =  <div className='modal_chat'>\r\n\t\t\t\t\t\t\t<div className={chat_class} onAnimationEnd={this.AnimationEnd}>\r\n\t\t\t\t\t\t\t\t<div className='video_chat_upper_panel'>\r\n\t\t\t\t\t\t\t\t\t<div className='video_upper_panel_name'>Видео чат</div>\r\n\t\t\t\t\t\t\t\t\t<div className='video_control_panel'>\r\n\t\t\t\t\t\t\t\t\t\t<div className='video_panel_close' onClick={this.dockVideoPanel}>\r\n\t\t\t\t\t\t\t\t\t\t\t<img src='img/panel_video.png' className='video_panel_dock' />\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div className='video_close' onClick={this.chatClose}>X</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className='video_container'>\r\n\t\t\t\t\t\t\t\t\t<video className='receive_video' autoPlay ref={(video)=>{this.receiveVideo = video;}} />\r\n\t\t\t\t\t\t\t\t\t<video id='local_video'autoPlay ref={(video)=>{this.localVideo = video;}}/>\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tthis.state.isDockPanel?dock_panel:null\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t   </div>;\r\n\t\t}\r\n\t\t\r\n\t\tvar msgBox = <MessageBox type='confirm' effect='backInLeft' render={(state)=>{this.setState ({Msg:null});this.ReconnectChat(state);}} effectOut='zoomOutRight'>{this.state.Msg}</MessageBox>;\r\n\t\tvar videoMsg = <MessageBox type='confirm' effect='backInLeft' render={(state)=>{this.setState ({videoMsg:null});this.reInvite(state);}} effectOut='zoomOutRight'>{this.state.videoMsg}</MessageBox>;\r\n\t\tvar closeMsg = <MessageBox type='confirm' effect='backInLeft' render={(state)=>{this.setState ({closeMsg:null});this.closeVideoChat(state);}} effectOut='zoomOutRight'>{this.state.closeMsg}</MessageBox>;\r\n\r\n\t\treturn(\r\n\t\t\t<div>\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.state.isChat?chatbox:null\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t\t{\r\n\t    \t\t\tthis.state.Msg?msgBox:null\r\n\t    \t\t}\r\n\t    \t\t{\r\n\t    \t\t\tthis.state.videoMsg?videoMsg:null\r\n\t    \t\t}\r\n\t    \t\t{\r\n\t    \t\t\tthis.state.closeMsg?closeMsg:null\r\n\t    \t\t}\r\n\t    \t\t{\r\n\t    \t\t\tthis.state.alertMsg?<MessageBox type='alert' effect='rubberBand' render={()=>{this.setState({alertMsg:null})}} effectOut='rotateOut'>{this.state.alertMsg}</MessageBox>:null\r\n\t    \t\t}\t    \t\t\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default ChatContainer","import React, {Component} from 'react'\r\nimport {MessageBox} from './start'\r\nimport ChatContainer from './chat'\r\nimport {\r\n  isMobile,\r\n  isAndroid\r\n} from \"react-device-detect\";\r\nimport './css/trainer.css'\r\n\r\nfunction Passport(props) {\r\n\tfunction ClickPhoto(event) {\r\n\t\tprops.ClickPhoto(props.indexLevel,event.clientX,event.clientY);\r\n\t}\r\n\treturn <div className='passe-partout' onClick={ClickPhoto}>{props.children}</div>;\r\n}\r\n\r\nfunction BlockExercise(props) {\r\n\treturn <div className='block_main_ex'>{props.children}</div>;\r\n}\r\n\r\nfunction Equipments(props) {\r\n\treturn <div className='equipment'>{props.children}</div>;\r\n}\r\n\r\nfunction WrapColumn(props) {\r\n\treturn <div className='wrap_column'>{props.children}</div>;\r\n}\r\n\r\nfunction MainExercise(props) {\r\n\tvar level = props.indexLevel;\r\n\r\n\tfunction ShowPhoto() {\r\n\t\tprops.ShowPhoto (level,props.complex_photos[0],props.complex_details[0],props.src_video[0]);\r\n\t}\r\n\r\n\treturn <div className=\"exercise_name\" onClick={ShowPhoto}>{props.children}</div>\r\n}\r\n\r\nfunction AddExercise(props) {\r\n\tvar level = props.level;\r\n\tvar number = props.number;\r\n\tvar animation = props.animation;\r\n\tvar last_element = props.last;\r\n\r\n\tfunction ShowPhoto() {\r\n\t\tprops.ShowPhoto (level,props.complex_photos[number],props.complex_details[number],props.src_video[number]);\r\n\t}\r\n\r\n\tfunction Animationend() {\r\n\t\tprops.DeleteMoreExercises (level);//для мобильных устройств\r\n\t}\r\n\r\n\tif (animation == 'hide')\r\n\t\treturn <li onAnimationEnd={last_element?Animationend:null} className='animation_lists_hide'>{props.children}</li>;\r\n\treturn <li className='animation_lists_show' onClick={ShowPhoto} >{props.children}</li>;\r\n}\r\n\r\nfunction AlternativeExercises(props) {\r\n\r\n\tfunction getKey(str){\r\n      let key = 0;\r\n      for (let i = 0; i < str.length; i++) {\r\n        key += str.charCodeAt(i);\r\n      }\r\n      return key.toString();\r\n    }\r\n\r\n    var level = props.indexLevel;\r\n    var animation = props.animation;\r\n    const list = props.exercises;\r\n    var i = 0;\r\n    var last = list.length-1;\r\n\r\n    const items = list.map((exercise) => {\r\n      const key = getKey(exercise)\r\n\r\n      return <AddExercise \r\n      \t\t\tlast={i==last? true:false} level={level} number={i++} animation={animation} DeleteMoreExercises={props.DeleteMoreExercises} \r\n      \t\t \tShowPhoto={props.ShowPhoto} src_video={props.src_video} complex_photos={props.complex_photos} complex_details={props.complex_details} key={key}> \r\n      \t\t \t{exercise}\r\n      \t\t </AddExercise>;\r\n    });\r\n    items.splice (0,1);\r\n\r\n    return (<ul className=\"list_exercise\">{items}</ul>);\r\n}\r\n\r\nfunction CreateTrainComponents(props) {\r\n\tvar Exercises;\r\n\tvar rows=[];\r\n\tvar columns=[];\r\n\tvar complex = props.complex;\r\n\tvar photos = props.photos;\r\n\tvar details = props.details;\r\n\tvar buttonShow = props.buttonShow;\r\n\tvar moreExercises = props.moreExercises;\r\n\tvar key=0;\r\n\r\n\tphotos.map ((photo,index)=>  {\r\n\t\tlet passport = <Passport \r\n\t\t\t\t\t\t\tClickPhoto={props.ClickPhoto} indexLevel={index}>\r\n\t\t\t\t\t\t\t<img src={photo} className='photo_equip'/>\r\n\t\t\t\t\t\t\t<div className='info'>{details[index].rounds}x{details[index].reps}</div>\r\n\t\t\t\t\t   </Passport>;\r\n\t\tlet block = <BlockExercise>\r\n\t\t\t\t\t<ButtonShow onButtonShowHadler={props.onButtonShowHadler} indexLevel={index}>{buttonShow[index]}</ButtonShow>\r\n\t\t\t\t\t<MainExercise \r\n\t\t\t\t\t\tShowPhoto={props.ShowPhoto} src_video={complex.src_video[index]} complex_details={complex.details[index]} complex_photos={complex.photo_equip[index]} \r\n\t\t\t\t\t\tindexLevel={index}>{complex.exercise_name[index][0]}\r\n\t\t\t\t\t</MainExercise>\r\n\t\t\t\t\t</BlockExercise>;\r\n\t\tif (moreExercises[index]!=null)\r\n\t\t\tExercises = <AlternativeExercises \r\n\t\t\t\t\t\t\tDeleteMoreExercises={props.DeleteMoreExercises} animation={moreExercises[index]} indexLevel={index} src_video={complex.src_video[index]}\r\n\t\t\t\t\t\t\texercises={complex.exercise_name[index]} ShowPhoto={props.ShowPhoto} complex_details={complex.details[index]} complex_photos={complex.photo_equip[index]}\r\n\t\t\t\t\t\t/>\r\n\t\telse\r\n\t\t\tExercises = null;\r\n\t\tcolumns.push (<Equipments key={++key}>{passport}{block}{Exercises}</Equipments>);\r\n\t});\r\n\r\n\tvar prev = null;\r\n\tvar count = 0;\r\n\tcolumns.map((column) => {\r\n\t\t++count;\r\n\t\tif (!prev)\r\n\t\t\tprev = column;\r\n\t\tif (count==2) {\r\n\t\t\trows.push (<WrapColumn key={++key}>{prev}{column}</WrapColumn>);\r\n\t\t\tprev = null;\r\n\t\t\tcount = 0;\r\n\t\t}\t\t\t\r\n\t});\r\n\tif (prev)\r\n\t\trows.push (<WrapColumn key={++key}>{prev}</WrapColumn>);\r\n\r\n\treturn (<div>{rows}</div>);\r\n}\r\n\r\nclass ButtonShow extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.onChangeState = this.onChangeState.bind(this);\r\n\t}\r\n\r\n\tonChangeState(event) {\r\n\t\tvar level = this.props.indexLevel;\r\n\t\tthis.props.onButtonShowHadler (level);\r\n\t}\r\n\r\n\trender() {\r\n\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<button className=\"button_list_ex\" onClick={this.onChangeState}><b>{this.props.children}</b></button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nclass HeadBar extends Component {\r\n\tconstructor(props) {\r\n      super(props);\r\n      this.state = {isMsg:null,isChatBox:false};\r\n      this.typeChat = '';\r\n      this.onClickPlay = this.onClickPlay.bind(this);\r\n      this.onChatBox = this.onChatBox.bind(this);\r\n      this.onVideoChatBox = this.onVideoChatBox.bind(this);\r\n      this.onFullScreen = this.onFullScreen.bind(this);\r\n    }\r\n\r\n    onFullScreen() {\r\n    \tvar doc = window.document;\r\n    \tvar docEl = doc.documentElement;\r\n\r\n    \tvar requestFullScreen = docEl.requestFullscreen || docEl.mozRequestFullScreen || docEl.webkitRequestFullScreen || docEl.msRequestFullscreen;\r\n    \tvar cancelFullScreen = doc.exitFullscreen || doc.mozCancelFullScreen || doc.webkitExitFullscreen || doc.msExitFullscreen;\r\n\r\n    \tif(!doc.fullscreenElement && !doc.mozFullScreenElement && !doc.webkitFullscreenElement && !doc.msFullscreenElement) {\r\n\t\t    requestFullScreen.call(docEl);\r\n\t\t}\r\n\t\telse {\r\n\t\t    cancelFullScreen.call(doc);\r\n\t\t}\r\n    }\r\n\r\n    onChatBox() {\r\n    \tthis.typeChat = 'textChat';\r\n    \tthis.setState ({isChatBox:true});\r\n    }\r\n\r\n    onVideoChatBox() {\r\n    \tthis.typeChat = 'videoChat';\r\n    \tthis.setState ({isChatBox:true});\r\n    }\r\n\r\n    onClickPlay() {\r\n    \tif (this.props.video==null)\r\n    \t\tthis.setState ({isMsg:'Сначала выберите упражнение для просмотра видео'});\r\n    \telse\r\n    \tif (this.props.video=='')\r\n    \t\tthis.setState ({isMsg:'Видеоролик не добавлен администратором'});\r\n    \telse\r\n    \t\tthis.props.PlayVideo();\r\n    }\r\n\r\n\trender() {\r\n\t\tvar controlScreen = null;\r\n\t\tvar player_class,class_webcam;\r\n\t\tvar player = this.props.player;\r\n\t\tvar user_name = this.props.user_name;\r\n\t\tvar ws_server = this.props.ws_server;\r\n\r\n\t\tif (isAndroid && isMobile)\r\n\t\t\tcontrolScreen=<div className='wrap_control' onClick={this.onFullScreen}><img className='fullScreen' src='img/full_scr.png'/></div>;\r\n\r\n\t\tif (player)\r\n\t\t{\t\r\n\t\t\t(player=='show')?player_class='video_player animation_player_show':player_class='video_player animation_player_hide';\r\n\t\t}else\r\n\t\t\tplayer_class = 'video_player';\r\n\r\n\t\treturn (\r\n\t\t\t<div className='header_back'>\r\n\t\t\t\t{\r\n\t\t\t\t\t(this.props.video!='')?\r\n\t\t\t\t\t\t<iframe src={this.props.video} className={player_class} title=\"YouTube video player\" allow=\"accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" \r\n\t\t\t\t\t\tallowFullScreen/>:null\r\n\t\t\t\t}\r\n\t\t\t\t<div className=\"header\">\t\t\t\t\r\n\t\t\t\t\t<div className='controls_container'>\r\n\t\t\t\t\t\t<div className='wrap_control' onClick={this.onChatBox}><img className='chatBox' src='img/chat-box.png'/></div>\r\n\t\t\t\t\t\t<div className='wrap_control' onClick={this.onClickPlay}><img id='youtube' src='img/youtube.png'/></div>\r\n\t\t\t\t\t\t<div className='wrap_control' onClick={this.onVideoChatBox}><img className='webCam' src='img/webcam96_off.png'/></div>\r\n\t\t\t\t\t\t{controlScreen}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t{\r\n    \t\t\t\tthis.state.isMsg?<MessageBox type='alert' effect='rubberBand' render={()=>{this.setState({isMsg:null})}} effectOut='rotateOut'>{this.state.isMsg}</MessageBox>:null\r\n    \t\t\t}\r\n    \t\t\t{\r\n    \t\t\t\tthis.state.isChatBox?<ChatContainer typeChat={this.typeChat} user_name={user_name} ws_server={ws_server} render={()=>{this.setState({isChatBox:null})}}/>:null\r\n    \t\t\t}\r\n\t\t\t</div>\r\n\t\t);\r\n\t} \t   \t    \t\r\n}\r\n\r\nclass ToolTip extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {toolTip:null};\r\n\t\tthis.out = false;\r\n\t\tthis.tool_class='';\r\n\r\n\t\tthis.clickHandler = this.clickHandler.bind(this);\r\n\t\tthis.AnimationEnd = this.AnimationEnd.bind(this);\r\n\t}\r\n\r\n\tAnimationEnd() {\r\n\t\tif (this.out)\r\n\t\t\tthis.props.render();\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.tool_class = 'weight animate__animated animate__' + this.props.effect;\r\n\t\tthis.setState ({toolTip:true});\r\n\t}\r\n\r\n\tclickHandler () {\r\n\t\tthis.tool_class = 'weight animate__animated animate__' + this.props.effectOut;\r\n\t\tthis.out = true;\r\n\t\tthis.setState ({toolTip:true});\r\n\t}\r\n\r\n\trender () {\r\n\t\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t{\r\n\t\t\t\tthis.state.toolTip?\r\n\t\t\t\t<div className={this.tool_class} style={{left:this.props.posX,top:this.props.posY}} onClick={this.clickHandler} onAnimationEnd={this.AnimationEnd}>\r\n\t\t\t\t\t<div className='weight_text'>{this.props.children}</div>\r\n\t\t\t\t</div>:null\r\n\t\t\t}\t\t\t\t\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nclass TrainExercise extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {photos:[],buttonShow:[],moreExercises:[],details:[],video:null,player:null,chat:null,headBarVisible:true,toolTip:false};\r\n\t\tthis.arrayVideo = [];\r\n\t\tthis.posX=0;\r\n\t\tthis.posY=0;\r\n\r\n\t\tthis.onButtonShowHadler = this.onButtonShowHadler.bind(this);\r\n\t\tthis.onChatHandler = this.onChatHandler.bind(this);\r\n\t\tthis.DeleteMoreExercises = this.DeleteMoreExercises.bind(this);\r\n\t\tthis.ShowPhoto = this.ShowPhoto.bind(this);\r\n\t\tthis.PlayVideo = this.PlayVideo.bind(this);\r\n\t\tthis.ClickPhoto = this.ClickPhoto.bind(this);\r\n\t\tthis.setVisibleHeadBar = this.setVisibleHeadBar.bind(this);\r\n\t}\r\n\r\n\tsetVisibleHeadBar(visible) {\r\n\t\tthis.setState ({headBarVisible:visible});\r\n\t}\r\n\r\n\tonChatHandler() {\r\n\t\tvar chat = this.state.chat;\r\n\t\r\n\t\tif (chat==null || chat=='hide')\t\r\n\t\t{\r\n\t\t\tchat = 'show';\r\n\t\t}\t\t\t\t\t\t\r\n\t\telse\r\n\t\t{\r\n\t\t\tchat = 'hide';\r\n\t\t}\r\n\t\tthis.setState ({chat:chat});\r\n\t}\r\n\r\n\tClickPhoto(index,posX,posY) {\r\n\t\tvar tooltip;\r\n\t\tvar video = this.arrayVideo[index];\r\n\r\n\t\tthis.posX = posX-100;\r\n\t\tthis.posY = posY-75;\r\n\t\tvideo==''?tooltip=false:tooltip=true;\r\n\t\tthis.setState ({video:video,toolTip:tooltip});\r\n\t}\r\n\r\n\tPlayVideo() {\r\n\t\tvar video = this.state.video;\r\n\t\tvar player = this.state.player;\r\n\r\n\t\tif (player==null || player=='hide')\r\n\t\t\tplayer = 'show';\r\n\t\telse\r\n\t\t\tplayer = 'hide';\r\n\t\tthis.setState ({player:player});\r\n\t}\r\n\r\n\tShowPhoto(index,photo,detail,src_video) {\r\n\t\tvar photos = this.state.photos;\r\n\t\tvar details = this.state.details;\r\n\r\n\t\tphotos[index] = photo;\r\n\t\tdetails[index] = detail;\r\n\t\tthis.arrayVideo[index] = src_video;\r\n\t\tthis.setState ({photos:photos,details:details,video:src_video});\r\n\t}\r\n\r\n\tDeleteMoreExercises(level) {\r\n\t\tvar moreExercises = this.state.moreExercises;\r\n\t\tvar photos = this.state.photos;\r\n\t\tvar details = this.state.details;\r\n\t\tvar complex = this.props.complex;\r\n\r\n\t\tmoreExercises[level] = null;\r\n\t\tphotos[level] = complex.photo_equip[level][0];\r\n\t\tdetails[level] = complex.details[level][0];\r\n\t\tthis.setState ({photos:photos,moreExercises:moreExercises,details:details});\r\n\t}\r\n\r\n\tonButtonShowHadler(level) {\r\n\t\tvar buttonShow = this.state.buttonShow;\r\n\t\tvar moreExercises = this.state.moreExercises;\r\n\t\tif (buttonShow[level]=='-')\r\n\t\t{\r\n\t\t\tbuttonShow[level] = '+';\r\n\t\t\tmoreExercises[level] = 'hide';\r\n\t\t}\r\n\t\telse \r\n\t\t{\r\n\t\t\tbuttonShow[level] = '-';\r\n\t\t\tmoreExercises[level] = 'show';\r\n\t\t}\r\n\r\n\t\tthis.setState ({buttonShow:buttonShow,moreExercises:moreExercises});\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tvar buttonShow = [];\r\n\t\tvar moreExercises = []; \r\n\t\tvar details = [];\r\n\t\tvar complex = this.props.complex;\r\n\r\n\t\tvar photos = complex.photo_equip.map((photos,index)=> {\r\n\t\t\tbuttonShow.push ('+');\r\n\t\t\tmoreExercises.push (null);\r\n\t\t\tdetails.push (complex.details[index][0]);\r\n\t\t\tthis.arrayVideo.push (complex.src_video[index][0]);\r\n\t\t\treturn photos[0];\r\n\t\t});\r\n\t\tthis.setState ({photos:photos,buttonShow:buttonShow,moreExercises:moreExercises,details:details});\r\n\t}\r\n\r\n\trender() {\r\n\t\tvar complex = this.props.complex;\r\n\t\tvar user_name = this.props.user_name;\r\n\t\tvar photos = this.state.photos;\r\n\t\tvar video = this.state.video;\r\n\t\tvar buttonShow = this.state.buttonShow;\r\n\t\tvar moreExercises = this.state.moreExercises;\r\n\t\tvar details = this.state.details;\r\n\t\tvar player = this.state.player;\r\n\t\t//var chat = this.state.chat;\r\n\t\t\r\n\t\treturn (\t\t\t\t\t\r\n\t\t\t<div>\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.state.headBarVisible?<HeadBar user_name={user_name} video={video} player={player} PlayVideo={this.PlayVideo} ws_server={this.props.ws_server} />:null\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t<div className='full_wrap'>\t\t\t\t\t\r\n\t\t\t\t\t<CreateTrainComponents \r\n\t\t\t\t\t\tDeleteMoreExercises={this.DeleteMoreExercises} onButtonShowHadler={this.onButtonShowHadler} moreExercises={moreExercises} buttonShow={buttonShow} photos={photos} \r\n\t\t\t\t\t\tcomplex={complex} ShowPhoto={this.ShowPhoto} details={details} ClickPhoto={this.ClickPhoto} \r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<div className='empty' />\r\n\t\t\t\t</div>\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.state.toolTip?<ToolTip posX={this.posX} posY={this.posY} effect='rotateIn' effectOut='rotateOut' render={()=>{this.setState({toolTip:false});}}>\r\n\t\t\t\t\tДля просмотра ролика нажмите кнопку YouTube</ToolTip>:null\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\nexport default TrainExercise","import React, {Component} from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport TrainExercise from './trainer'\r\nimport {\r\n  isMobile,\r\n  isDesktop,\r\n  isIE,\r\n  isEdge\r\n} from \"react-device-detect\";\r\nimport './css/start.css'\r\nimport './css/landscape1000.css'\r\nimport './css/landscape.css'\r\n\r\nclass MessageBox extends Component {\r\n   constructor(props) {\r\n      super(props);\r\n      this.state = {showBox:false,boxPos:{}};\r\n      this.class_box = 'msg_box';\r\n      this.isCloseState = null;\r\n      this.isDownMouse = false;\r\n      this.delta = {};\r\n\r\n      this.AnimationEnd = this.AnimationEnd.bind(this);\r\n      this.ClickButton = this.ClickButton.bind(this);\r\n      this.handleMouseDown = this.handleMouseDown.bind(this);\r\n      this.handleMouseUp = this.handleMouseUp.bind(this);\r\n      this.handleMouseMove = this.handleMouseMove.bind(this);\r\n    }\r\n\r\n    AnimationEnd() { \r\n      this.class_box = 'msg_box';\r\n      if (this.isCloseState)\r\n        this.props.render(this.isCloseState);\r\n    }\r\n\r\n    componentDidMount() {\r\n      if (typeof this.props.effect!='undefined') {\r\n        this.class_box += ' animate__animated animate__' + this.props.effect;\r\n      }\r\n      this.setState ({showBox:true});\r\n    }\r\n\r\n    componentDidUpdate(prevProps) {\r\n       if (this.isCloseState && (isIE || isEdge)) {\r\n          setTimeout (()=>{this.props.render(this.isCloseState);},1500);\r\n       }\r\n    }\r\n\r\n    ClickButton(event) {\r\n      if (typeof this.props.effectOut!='undefined') {\r\n\r\n        this.isCloseState = event.target.textContent;\r\n        this.class_box += ' animate__animated animate__' + this.props.effectOut;\r\n        this.setState ({showBox:true});\r\n\r\n      }else\r\n\r\n      this.props.render(event.target.textContent);\r\n    }\r\n\r\n    handleMouseDown(event) {\r\n      var rect=this.msgBox.getBoundingClientRect();\r\n      \r\n      this.delta = {left:event.clientX-rect.left,top:event.clientY-rect.top};\r\n      this.isDownMouse = true ; \r\n    }\r\n\r\n    handleMouseUp() {\r\n      this.isDownMouse = false ;\r\n    }\r\n\r\n    handleMouseMove(event) {\r\n      if (this.isDownMouse) {\r\n        var left = event.clientX-this.delta.left;\r\n        var top = event.clientY-this.delta.top;\r\n\r\n        this.class_box = 'msg_box1';\r\n        this.setState({boxPos:{left:left,top:top}});\r\n      }\r\n    }\r\n\r\n    render() {\r\n      var buttons,box;\r\n\r\n      if (this.props.type=='confirm') {\r\n\r\n        buttons = <div className='container_buttons'><button className='button_yes' onClick={this.ClickButton}>Да</button>\r\n                  <button className='button_no' onClick={this.ClickButton}>Нет</button></div>;  \r\n      } else\r\n        buttons = <div className='container_button'><button onClick={this.ClickButton}>Ok</button></div>;\r\n\r\n      box = <div className={this.class_box} style={this.state.boxPos} onAnimationEnd={this.AnimationEnd} ref={(box)=>{this.msgBox=box;}}>\r\n                <div className='upper_panel' onMouseDown={this.handleMouseDown} >Внимание</div>\r\n                <div className='container_text'>{this.props.children}</div>\r\n                {buttons}\r\n            </div>;\r\n\r\n      return(\r\n        <div className='modal' onMouseMove={this.handleMouseMove} onMouseUp={this.handleMouseUp}>\r\n        {\r\n          this.state.showBox?box:null\r\n        }\r\n        </div>\r\n        );\r\n    }\r\n}\r\n\r\n\r\nclass ClipsAnimation extends Component {\r\n   constructor(props) {\r\n      super(props);\r\n      this.state = {arrayClips:[]};\r\n      this.arrayImage = [{front_video:'clips/1.mp4',back_video:'clips/6.mp4'},\r\n                         {front_video:'clips/2.mp4',back_video:'clips/7.mp4'},\r\n                         {front_video:'clips/3.mp4',back_video:'clips/8.mp4'},\r\n                         {front_video:'clips/4.mp4',back_video:'clips/9.mp4'},\r\n                         {front_video:'clips/5.mp4',back_video:'clips/10.mp4'},\r\n                         {front_video:'clips/1.mp4',back_video:'clips/6.mp4'}\r\n                        ];\r\n      this.animation = {reverseIn:'animate__flipInY',reverseOut:'animate__flipOutY',delayIn:'animate__delay-0s',delayOut:'animate__delay-0s'};                    \r\n      this.createClip = false;\r\n      this.front_video_reverse=null;\r\n      this.back_video_reverse=null;\r\n      this.indexReverse=0;//IE\r\n      this.arrayVideo = [];\r\n      this.lastVideo=null;\r\n      this.interval = null;\r\n\r\n      this.shiftClips = this.shiftClips.bind(this);\r\n      this.createArrayClips = this.createArrayClips.bind(this);\r\n      this.ReverseClip = this.ReverseClip.bind(this);\r\n      this.PlayVideo = this.PlayVideo.bind(this);\r\n      this.PlayVideo_ = this.PlayVideo_.bind(this); //IE\r\n      this.reInitClips = this.reInitClips.bind(this);\r\n    }\r\n\r\n    shiftClips() {\r\n      this.arrayImage.shift();\r\n      this.arrayImage[this.arrayImage.length] = this.arrayImage[0];\r\n\r\n      this.arrayVideo.forEach((video,index)=> {\r\n        var class_clip = 'animation_clip'+(index+1);\r\n        var list = video.classList;\r\n\r\n        for (var i = 0; i < list.length; i++) {\r\n          if (list[i].indexOf('animation_clip') != -1)\r\n            video.classList.remove (list[i]);\r\n        }\r\n\r\n        video.classList.remove(this.animation.reverseIn);\r\n        video.classList.remove(this.animation.delayIn);\r\n        \r\n        video.classList.add (class_clip);\r\n      });\r\n      this.lastVideo = this.arrayVideo.shift();     \r\n      this.arrayVideo[this.arrayVideo.length] = this.lastVideo;    \r\n\r\n      if ((isIE || isEdge) && isDesktop) {\r\n\r\n         this.interval = setTimeout (()=>{this.reInitClips();},3000);\r\n      }  \r\n    }\r\n\r\n    reInitClips() {\r\n      var last_index = this.arrayImage.length-1;            \r\n\r\n      this.arrayVideo[last_index].src = this.arrayImage[0].front_video;\r\n      this.arrayVideo.forEach((video,index)=> {\r\n        var list = video.classList;\r\n\r\n        for (var i = 0; i < list.length; i++) {\r\n          if (list[i].indexOf('clip') != -1 && list[i].startsWith('clip'))\r\n            video.classList.remove (list[i]);\r\n        }      \r\n        video.classList.add('clip'+(index+1));\r\n\r\n        for (var i = 0; i < list.length; i++) {\r\n          if (list[i].indexOf('animation_clip') != -1)\r\n            video.classList.remove (list[i]);\r\n        }\r\n      });\r\n\r\n      if ((isIE || isEdge) && isDesktop) {\r\n        this.PlayVideo_(this.indexReverse);\r\n      }\r\n    }\r\n\r\n    PlayVideo_(index) {\r\n  \r\n      this.interval = setTimeout (()=>{this.ReverseClip(index,this.animation.reverseOut, this.animation.delayOut);},10000);\r\n    }\r\n\r\n    PlayVideo(index) {\r\n      this.arrayVideo[index].play()\r\n        .then(()=> {\r\n            var promise = new Promise((myResolve)=> {\r\n\r\n            this.interval = setTimeout (()=>{myResolve();},10000);\r\n          })\r\n          .then(()=> {\r\n              var promise = new Promise((myResolve)=> {\r\n\r\n                this.arrayVideo[index].onanimationend = ()=> {                   \r\n                  myResolve();\r\n                };\r\n                this.ReverseClip(index,this.animation.reverseOut, this.animation.delayOut);\r\n\r\n              })\r\n              .then(()=> {\r\n                  var promise = new Promise((myResolve)=> {\r\n                    \r\n                    this.arrayVideo[index].onanimationend = ()=> {\r\n                      myResolve();\r\n                    };\r\n\r\n                    this.arrayImage[index].front_video = this.back_video_reverse;\r\n                    this.arrayImage[index].back_video = this.front_video_reverse;\r\n          \r\n                    this.arrayVideo[index].src = this.arrayImage[index].front_video;\r\n                                       \r\n                    this.ReverseClip(index,this.animation.reverseIn, this.animation.delayIn);\r\n                  })\r\n                  .then(()=> {\r\n                    this.arrayVideo[index].play()\r\n                      .then(()=> {\r\n                          var promise = new Promise((myResolve)=> {\r\n\r\n                          this.interval = setTimeout (()=>{myResolve();},10000);\r\n                        })\r\n                        .then(()=>{\r\n                           var promise = new Promise((myResolve)=> {\r\n\r\n                            this.arrayVideo[index].onanimationend = ()=> {\r\n                              myResolve();\r\n                            };\r\n                            var last_index = this.arrayImage.length-1;\r\n                            this.arrayVideo[last_index].src = this.arrayImage[0].front_video;\r\n                            this.shiftClips();\r\n                          })\r\n                          .then(()=> {\r\n                            this.reInitClips();\r\n                            this.PlayVideo(index);\r\n                          });\r\n                        });\r\n                      });\r\n                  });\r\n              });\r\n          });            \r\n        });\r\n    }\r\n\r\n    createArrayClips() {\r\n      var autoplay = false;\r\n      var loop = false; \r\n\r\n      if ((isIE || isEdge) && isDesktop) {\r\n          autoplay = true;\r\n          loop = true;\r\n      } \r\n\r\n       var arrayClips = this.arrayImage.map((img,index) => {\r\n        var class_clip = 'video_img clip'+(index+1)+' animate__animated';  \r\n        \r\n        return <video key={index} className={class_clip} autoPlay={autoplay} loop={loop} muted src={img.front_video} ref={(video)=>{this.video=video;this.arrayVideo[index]=this.video;}}/>;\r\n      });\r\n      this.createClip = true;\r\n      this.setState ({arrayClips:arrayClips});\r\n    }\r\n\r\n    ReverseClip(indexReverse,effect,delay) {\r\n      this.indexReverse = indexReverse;\r\n   \r\n      this.front_video_reverse = this.arrayImage[indexReverse].front_video;\r\n      this.back_video_reverse = this.arrayImage[indexReverse].back_video;\r\n\r\n      \r\n      this.arrayVideo[indexReverse].classList.remove(this.animation.reverseIn);\r\n      this.arrayVideo[indexReverse].classList.remove(this.animation.reverseOut);     \r\n      this.arrayVideo[indexReverse].classList.remove(this.animation.delayOut);\r\n      this.arrayVideo[indexReverse].classList.remove(this.animation.delayIn);\r\n\r\n      this.arrayVideo[indexReverse].classList.add(effect);\r\n      this.arrayVideo[indexReverse].classList.add(delay);\r\n\r\n       if ((isIE || isEdge) && isDesktop) {\r\n        if (effect.indexOf('Out') != -1) {\r\n\r\n          this.arrayImage[this.indexReverse].front_video = this.back_video_reverse;\r\n          this.arrayImage[this.indexReverse].back_video = this.front_video_reverse;\r\n          \r\n          this.interval = setTimeout (()=>{\r\n\r\n            this.arrayVideo[this.indexReverse].src = this.arrayImage[this.indexReverse].front_video;\r\n            \r\n          },500);\r\n          this.interval = setTimeout (()=>{\r\n            \r\n            this.ReverseClip(indexReverse,this.animation.reverseIn,this.animation.delayIn);\r\n            \r\n          },1000);\r\n\r\n        } else {\r\n\r\n          var last_index = this.arrayImage.length-1;\r\n\r\n          this.arrayVideo[last_index].src = this.arrayImage[0].front_video;\r\n          this.interval = setTimeout (()=>{this.shiftClips();},10000);\r\n        }\r\n       }\r\n    }\r\n\r\n    componentDidMount() {\r\n      if ((isIE || isEdge) && !isDesktop)\r\n        return;\r\n      this.createArrayClips();\r\n    }\r\n\r\n    componentWillUnmount() {\r\n      if (!(isIE || isEdge)) {\r\n\r\n        this.arrayVideo.forEach((video,index)=> {\r\n          video.onanimationend = null;\r\n        });\r\n      }\r\n      \r\n      clearTimeout(this.interval);\r\n    }\r\n\r\n    componentDidUpdate(prevProps) {\r\n      if (this.createClip) {\r\n\r\n        this.createClip = false;\r\n        if (isIE || isEdge) {\r\n          if (isDesktop)\r\n            this.PlayVideo_(0);//IE\r\n        }\r\n        else\r\n          this.PlayVideo(0); \r\n      }\r\n    }\r\n\r\n    render() {\r\n      return (\r\n        <div className='video_block'>                  \r\n          {\r\n            \r\n            this.state.arrayClips\r\n          }                   \r\n        </div>\r\n      );\r\n    }\r\n}\r\n\r\nfunction Lenta(props) {\r\n  var class_lenta;\r\n  var array_win = [];\r\n  var array_win_ = [];\r\n\r\n  for (var i = 0; i <= 34; i++) {\r\n    array_win.push(<div key={i} className='lenta_win'/>);\r\n  }\r\n  for (var i = 0; i <= 18; i++) {\r\n    array_win.push(<div key={i+35} className='lenta_win_'/>);\r\n  }\r\n\r\n  props.pos=='up'?class_lenta='lenta':class_lenta='lenta2';\r\n\r\n  return <div className={class_lenta}>{array_win}{array_win_}</div>;\r\n}\r\n\r\nfunction BackImage(props) {\r\n\tif (typeof props.width!='undefined' && typeof props.height!='undefined')\r\n\t\treturn <img src={props.photo_src} width={props.width} height={props.height} className={props.class_name} alt='' />\r\n\treturn <img src={props.photo_src} className={props.class_name} alt='' />\r\n}\r\n\r\nfunction AnimationText(props) {\r\n\treturn <div className={props.class_name} id={props.text_id}>{props.children}</div>;\r\n}\r\n\r\nfunction AnimationHead() {\r\n\treturn (\r\n\t\t<div className='name_head'>\r\n\t\t\t<AnimationText class_name='name_head1 animate__animated animate__bounceInLeft animate__delay-1s animate__slow' text_id='head_name1'>Тренер</AnimationText>\r\n\t\t\t<AnimationText class_name='name_head2 animate__animated animate__bounceInRight animate__delay-1s animate__slow' text_id='head_name2'>онлайн</AnimationText>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nfunction FormEntry(props) {\r\n\treturn (\r\n\t\t<div className={props.class_name} id={props.form_id}>\r\n\t\t\t<div className=\"my_logo\">Copyright Бойчук Ярослав</div>\r\n\t\t\t<InputsBlock onLogon={props.onLogon} onSaveData={props.onSaveData} isSaveData={props.isSaveData} />\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nclass InputsBlock extends Component {\r\n\t constructor(props) {\r\n      super(props);\r\n      this.state = {login: '', password: ''};\r\n\r\n      this.onChangeLogin = this.onChangeLogin.bind(this);\r\n      this.onChangePassword = this.onChangePassword.bind(this);\r\n      this.onClickHandler = this.onClickHandler.bind(this);     \r\n      this.handlerKey = this.handlerKey.bind(this);\r\n    }\r\n\r\n    onChangePassword(event){\r\n      this.setState({password: event.target.value});\r\n    }\r\n\r\n    onChangeLogin(event) {\r\n      this.setState({login: event.target.value});\r\n    }\r\n\r\n    onClickHandler(event) {     \r\n   \t  this.props.onLogon ({user_name:this.state.login,password:this.state.password});\r\n    }\r\n\r\n    handlerKey(event) {\r\n      if (event.keyCode === 13 || event.keyCode === 14) {\r\n\t\t  this.onClickHandler();\r\n\t  }\r\n}\r\n\r\n\trender() {\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"input_block\">\r\n\t\t\t\t<p><b>Введите имя пользователя:</b></p>\r\n\t\t\t\t<input type=\"text\" id=\"usr\" value={this.state.login} onChange={this.onChangeLogin} />\r\n\t\t\t\t<p><b>Введите пароль:</b></p>\r\n\t\t\t\t<input type=\"password\" id=\"pass\" value={this.state.password} onChange={this.onChangePassword} onKeyUp={this.handlerKey} />\r\n\t\t\t\t<input type=\"button\" id=\"btn\" value=\"Подтвердить\" onClick={this.onClickHandler} />\r\n\t\t\t\t<p><input type=\"checkbox\" checked={this.props.isSaveData} id=\"chk\" onChange={this.props.onSaveData} /><span><b>Сохранить данные</b></span></p>            \r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nfunction Logon(props) {\r\n  var class_logon = 'logon_container';\r\n\r\n  if (isMobile)\r\n      class_logon += ' animate__animated animate__backInLeft';\r\n\treturn (    \r\n      <div className='back'>\t   \t\r\n      \t<div className={class_logon}>\r\n  \t    \t<AnimationHead />\r\n  \t    \t<FormEntry form_id='frm0' class_name='frame' onLogon={props.onLogon} onSaveData={props.onSaveData} isSaveData={props.isSaveData} />          \r\n      \t</div>        \r\n        <Lenta pos='up'/>\r\n        <ClipsAnimation />\r\n        <Lenta pos='down'/>      \r\n      </div>\r\n    );\r\n}\r\n\r\nclass Start extends Component {\r\n\tconstructor(props) {\r\n      super(props);\r\n      this.state = {showLogon:false,isSaveData:true,isMsg:false};\r\n\r\n      this.user_exist=false;\r\n      this.users = null;\r\n      this.agentInfo = '';\r\n\r\n      this.onLogon = this.onLogon.bind(this);\r\n      this.onStateLogon = this.onStateLogon.bind(this);\r\n      this.onSaveData = this.onSaveData.bind(this);\r\n      this.checkCookie = this.checkCookie.bind(this);\r\n      this.CheckUser = this.CheckUser.bind(this);    \r\n      this.setCookie = this.setCookie.bind(this);\r\n      this.getCookie = this.getCookie.bind(this);\r\n      this.getConfig = this.getConfig.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    var account = this.checkCookie();\r\n    \r\n  \tif (!account)\r\n  \t\tthis.onStateLogon(true);\r\n  \telse     \r\n      this.CheckUser(account);\r\n  }\r\n\r\n  CheckUser(account) {\r\n\r\n    fetch('json/users.json')\r\n      .then((result) => result.json())\r\n      .then((result) => {\r\n\r\n        this.users = result;\r\n        var i = this.users.usr_name.findIndex ( (name)=> {return name==account.user_name;});\r\n\r\n        if (i!=-1 && this.users.usr_pass[i]==account.password) {\r\n\r\n          if (this.user_exist==false) {\r\n\r\n            if (this.state.isSaveData) {\r\n\r\n              this.setCookie(\"username\", account.user_name, 365);\r\n              this.setCookie(\"password\", account.password, 365);\r\n            }\r\n          }\r\n          \r\n          this.onStateLogon(false);\r\n\r\n          var conf_json = this.users.usr_conf[i];\r\n\r\n          if (conf_json !=null && conf_json !='') {\r\n\r\n            this.getConfig (conf_json,account.user_name,this.users.ws_server);\r\n          }          \r\n\r\n        }else {\r\n\r\n          if (this.user_exist==true) {\r\n\r\n            document.cookie = \"username=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;\";\r\n            document.cookie = \"password=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;\";\r\n            this.user_exist = false;\r\n            this.onStateLogon(true);\r\n\r\n          }else {\r\n            \r\n            this.setState({isMsg:true});\r\n          }      \r\n        }      \r\n      });    \r\n  }\r\n  \r\n  getConfig(config,user,ws_server) {\r\n    var complex,ws_server;\r\n    var xhttp = new XMLHttpRequest();\r\n\r\n    xhttp.onreadystatechange = ()=> {\r\n      if (xhttp.readyState == 4 && xhttp.status == 200) {\r\n          complex = JSON.parse(xhttp.responseText);  \r\n \r\n          this.props.render('none');\r\n          ReactDOM.render(\r\n            <TrainExercise complex={complex} user_name={user} ws_server={ws_server} />,\r\n            document.getElementById('wrap')\r\n          );\r\n      }\r\n    };\r\n    xhttp.open(\"GET\", config, true);\r\n    xhttp.send();\r\n  }\r\n\r\n  checkCookie() {\r\n    var account = {user_name:'',password:''};\r\n\r\n    account.password=this.getCookie(\"password\");\r\n    account.user_name=this.getCookie(\"username\");\r\n\r\n    this.user_exist=false;\r\n    \r\n    if (account.user_name != \"\") {\r\n        if (account.password == \"\")\r\n        {\r\n            return false;\r\n            //вывод формы на ввод\r\n        }else\r\n        {\r\n            this.user_exist=true;  \r\n            return account;       \r\n        }\r\n    } \r\n    return false;\r\n  }\r\n\r\n  setCookie(cname,cvalue,exdays) {\r\n    var d = new Date();\r\n\r\n    d.setTime(d.getTime() + (exdays*24*60*60*1000));\r\n    var expires = \"expires=\" + d.toGMTString();\r\n    document.cookie = cname + \"=\" + cvalue + \";\" + expires + \";path=/\";\r\n  }\r\n\r\n  getCookie(cname) {\r\n    var name = cname + \"=\";\r\n    var decodedCookie = decodeURIComponent(document.cookie);\r\n    var ca = decodedCookie.split(';');\r\n\r\n    for(var i = 0; i < ca.length; i++) {\r\n      var c = ca[i];\r\n      while (c.charAt(0) == ' ') {\r\n        c = c.substring(1);\r\n      }\r\n      if (c.indexOf(name) == 0) {\r\n        return c.substring(name.length, c.length);\r\n      }\r\n    }\r\n    return \"\";\r\n  }\r\n\r\n  onStateLogon(state) {\r\n\r\n  \tthis.setState({showLogon:state})\r\n  }\r\n\r\n  onLogon(account) {\r\n  \tthis.CheckUser(account);\r\n  \r\n  }\r\n\r\n  onSaveData(event) {\r\n      this.setState(prevState => ({\r\n        isSaveData: !prevState.isSaveData\r\n      }));      \r\n  }\r\n\r\n  render() {\r\n    \r\n    if (!this.state.showLogon) {\r\n      return null;\r\n    }\r\n\r\n  \treturn (\r\n  \t\t<div style={{width:'100%',height:'100%'}}>\r\n  \t\t\t<Logon onLogon={this.onLogon} onSaveData={this.onSaveData} isSaveData={this.state.isSaveData} />\r\n        {\r\n          this.state.isMsg?<MessageBox type='alert' effect='zoomInDown' render={()=>{this.setState({isMsg:false})}} effectOut='zoomOutDown'>Имя пользователя или пароль не верны</MessageBox>:null\r\n\r\n        }  \r\n  \t\t</div>\r\n  \t);\r\n  }\r\n}\r\n\r\nexport {Start,MessageBox}\r\n\r\n","import 'react-app-polyfill/ie9';\nimport 'react-app-polyfill/stable';\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport {Start} from './start'\n\nReactDOM.render(\n  <Start render={(state)=>{document.getElementById('logon').style.display=state;}} />,\n  document.getElementById('logon')\n);\n"],"sourceRoot":""}